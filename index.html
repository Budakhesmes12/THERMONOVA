<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>✨ Thermonova System</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@400;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<style>
  :root {
    --primary-light: #f8f8f8; /* Soft Off-White */
    --accent-blue: #3b82f6; /* Vibrant Blue */
    --accent-red: #ef4444; /* Bold Red */
  }
  body {
    font-family: 'Inter', sans-serif;
    background: var(--primary-light);
    color: #1e1e1e;
  }
  .doy-container {
    background: white;
    box-shadow: 0 10px 40px rgba(0,0,0,.1);
  }
  .doy-card {
    background: #fff;
    border: 1px solid #e5e7eb;
    border-radius: 1.5rem;
    box-shadow: 0 4px 12px rgba(0,0,0,.04);
    transition: all .4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }
  .doy-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 15px 30px rgba(0,0,0,.08);
  }
  .doy-pill {
    transition: all .3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }
  .doy-pill:hover {
    background: rgba(59, 130, 246, .08);
    transform: translateX(10px);
  }
  .doy-pill.active {
    background: var(--accent-blue);
    color: white;
    font-weight: 600;
  }
  .signature {
    font-family: 'Montserrat', sans-serif;
    font-weight: 500;
    color: var(--accent-blue);
  }
  .progress-ring {
    stroke-linecap: round;
    transition: stroke-dashoffset 0.35s;
    transform: rotate(-90deg);
    transform-origin: 50% 50%;
  }
  .data-flash {
    animation: flash 0.5s ease-out;
  }
  @keyframes flash {
    0% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.05); opacity: 0.8; }
    100% { transform: scale(1); opacity: 1; }
  }
  .greeting-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(5px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    animation: fadeIn 0.5s ease-out forwards;
  }
  .greeting-box {
    background: white;
    border: 2px solid var(--accent-blue);
    border-radius: 1.5rem;
    padding: 3rem;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0,0,0,.1);
    position: relative;
    animation: popUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
  }
  .close-button {
    position: absolute;
    top: 1rem;
    right: 1rem;
    color: #999;
    font-size: 1.5rem;
    cursor: pointer;
    transition: color 0.2s;
  }
  .close-button:hover {
    color: #555;
  }
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  @keyframes popUp {
    from { transform: scale(0.8); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }
</style>
</head>

<body class="text-gray-900">
<div class="min-h-screen flex items-center justify-center p-4 lg:p-8">
  <div class="w-full max-w-7xl rounded-3xl overflow-hidden flex flex-col lg:flex-row doy-container">

    <aside class="p-6 w-full lg:w-64 flex-shrink-0 border-r border-gray-200">
      <div class="flex items-center space-x-3 mb-10">
        <div class="p-3 text-accent-blue flex items-center justify-center">
          <i class="fas fa-microchip text-xl"></i>
        </div>
        <h2 class="text-xl font-bold text-gray-800 font-sans">
          Thermonova<span class="text-accent-blue"> System</span>
        </h2>
      </div>

      <nav class="space-y-2">
        <a href="#" id="navHome" class="doy-pill flex items-center space-x-3 px-4 py-3 rounded-xl text-gray-700 active">
          <i class="fas fa-chart-line text-accent-blue w-5"></i>
          <span>Dashboard</span>
        </a>

        <a href="#" id="navLive" class="doy-pill flex items-center space-x-3 px-4 py-3 rounded-xl text-gray-700">
          <i class="fas fa-fire text-accent-blue w-5"></i>
          <span>Live Data</span>
          <span class="ml-auto text-xs bg-red-500 text-white px-2 py-1 rounded-full animate-pulse">Live</span>
        </a>

        <a href="#" id="navChat" class="doy-pill flex items-center space-x-3 px-4 py-3 rounded-xl text-gray-700">
          <i class="fas fa-robot text-accent-blue w-5"></i>
          <span>AI Chatbot</span>
        </a>
      </nav>

      <div class="mt-auto pt-8 text-center lg:text-left">
        <div class="text-xs text-gray-500">
          Crafted with <i class="fas fa-heart text-red-400 mx-1"></i> by
          <br class="lg:hidden">
          <span class="signature">Thermonova Team</span>
        </div>
      </div>
    </aside>

    <main class="flex-1 p-6 lg:p-8 overflow-y-auto">

      <section id="homeSection">
        <header class="mb-8">
          <h1 class="text-2xl lg:text-3xl font-bold text-gray-800">
            Welcome to <span class="text-accent-blue">Thermonova</span> System
          </h1>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
          <div class="doy-card p-6">
            <h2 class="text-xl font-semibold text-accent-blue mb-4">About Thermonova</h2>
            <p class="text-gray-700 leading-relaxed">
              Thermonova is an innovative smart-environment control system designed to
              monitor temperature, humidity and water levels in real-time. Our mission is
              to provide efficient cooling and monitoring solutions for homes,
              greenhouses and industrial applications.
            </p>
          </div>
          <div class="doy-card p-6">
            <h2 class="text-xl font-semibold text-accent-blue mb-4">Key Features</h2>
            <ul class="list-disc list-inside space-y-2 text-gray-700">
              <li>Real-time sensor data monitoring.</li>
              <li>Automated cooling and misting control.</li>
              <li>Predictive analysis using AI.</li>
              <li>User-friendly dashboard for remote access.</li>
            </ul>
          </div>
        </div>

        <div class="doy-card p-6">
          <h2 class="text-xl font-semibold text-accent-blue mb-6 text-center">Thermonova Team</h2>
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-6 justify-items-center">
            <div class="text-center transition-transform hover:scale-105">
              <img src="siraizu.jpg" alt="Azib Hasif" class="mx-auto rounded-full w-32 h-32 object-cover mb-4 shadow-md border-2 border-accent-blue">
              <h3 class="font-semibold text-gray-800">Dr. Aizu</h3>
              <p class="text-sm text-gray-500">Supervisor</p>
            </div>
            <div class="text-center transition-transform hover:scale-105">
              <img src="hasif.jpg" alt="Member 2" class="mx-auto rounded-full w-32 h-32 object-cover mb-4 shadow-md border-2 border-accent-blue">
              <h3 class="font-semibold text-gray-800">Azib Hasif</h3>
              <p class="text-sm text-gray-500">Hardware/Software Engineer</p>
            </div>
            <div class="text-center transition-transform hover:scale-105">
              <img src="edmund.jpg" alt="Member 3" class="mx-auto rounded-full w-32 h-32 object-cover mb-4 shadow-md border-2 border-accent-blue">
              <h3 class="font-semibold text-gray-800">Edmund</h3>
              <p class="text-sm text-gray-500">Project Design</p>
            </div>
            <div class="text-center transition-transform hover:scale-105">
              <img src="nurin.jpg" alt="Member 4" class="mx-auto rounded-full w-32 h-32 object-cover mb-4 shadow-md border-2 border-accent-blue">
              <h3 class="font-semibold text-gray-800">Nurin Batrisyia</h3>
              <p class="text-sm text-gray-500">Research & Development</p>
            </div>
            <div class="text-center transition-transform hover:scale-105">
              <img src="fasha.jpg" alt="Member 5" class="mx-auto rounded-full w-32 h-32 object-cover mb-4 shadow-md border-2 border-accent-blue">
              <h3 class="font-semibold text-gray-800">Fasha Erika</h3>
              <p class="text-sm text-gray-500">Research & Development</p>
            </div>
          </div>
        </div>
      </section>

      <section id="liveSection" style="display:none">
        <header class="mb-8">
          <h1 class="text-2xl lg:text-3xl font-bold text-gray-800">
            Live <span class="text-accent-blue">Data</span>
          </h1>
          <p class="text-gray-600">Real-time environmental monitoring.</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
          <div class="col-span-1 flex flex-col gap-6">
            <div class="doy-card p-6 text-center">
              <div class="text-accent-red text-5xl mb-3">
                <i class="fas fa-thermometer-half"></i>
              </div>
              <h2 class="text-lg font-semibold text-gray-800">Temperature</h2>
              <p id="tempValue" class="text-4xl font-extrabold text-accent-red mt-2 animate-pulse">-- °C</p>
            </div>

            <div class="doy-card p-6 text-center">
              <div class="text-accent-blue text-5xl mb-3">
                <i class="fas fa-water"></i>
              </div>
              <h2 class="text-lg font-semibold text-gray-800">Humidity</h2>
              <p id="humValue" class="text-4xl font-extrabold text-accent-blue mt-2 animate-pulse">-- %</p>
            </div>

            <div class="doy-card p-6 text-center">
              <h2 class="text-lg font-semibold text-gray-800 mb-4">Water Level</h2>
              <div class="relative w-36 h-36 mx-auto">
                <svg class="w-full h-full" viewBox="0 0 36 36">
                  <circle class="text-gray-200" stroke="currentColor" stroke-width="3" fill="none" r="15.9155" cx="18" cy="18"></circle>
                  <circle id="waterRing" class="text-accent-blue progress-ring" stroke="currentColor" stroke-width="3" fill="none" r="15.9155" cx="18" cy="18"></circle>
                </svg>
                <div class="absolute inset-0 flex flex-col items-center justify-center">
                  <p id="waterValue" class="text-4xl font-extrabold text-accent-blue animate-pulse">-- %</p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-span-1 lg:col-span-2 doy-card p-6">
            <h2 class="text-xl font-semibold text-accent-blue mb-4">Temperature & Humidity Trends</h2>
            <div style="height: 400px;">
              <canvas id="tempHumChart"></canvas>
            </div>
          </div>
        </div>
        
      </section>

      <section id="chatSection" style="display:none; height: 80vh;">
        <header class="mb-4">
          <h1 class="text-2xl lg:text-3xl font-bold text-gray-800">
            <span class="text-accent-blue">AI Chatbot</span> – Thermonova Assistant
          </h1>
          <p class="text-gray-600">Ask me anything about Thermonova or sensor data.</p>
        </header>
        <iframe
          src="https://www.chatbase.co/chatbot-iframe/LYiq7d4uVcT4XlX0ZYWdZ"
          width="100%"
          style="height:100%;min-height:700px"
          frameborder="0">
        </iframe>
      </section>
    </main>
  </div>
</div>

<div id="greetingPopup" class="greeting-overlay">
  <div class="greeting-box">
    <button class="close-button" onclick="closeGreeting()">
      <i class="fas fa-times-circle"></i>
    </button>
    <div class="text-5xl text-accent-blue mb-4">
      <i class="fas fa-hand-holding-heart animate-bounce"></i>
    </div>
    <h1 class="text-3xl font-bold text-gray-800 mb-2">Welcome to Thermonova System!</h1>
    <p class="text-gray-600 mb-6">Your smart-environment control is ready.</p>
    <a href="#" class="inline-block px-6 py-3 font-semibold text-white bg-accent-blue rounded-full transition-transform transform hover:scale-105" onclick="closeGreeting()">
      Explore Now
    </a>
  </div>
</div>

<script>
  // ===== Navigation & Section Management =====
  const navHome = document.getElementById('navHome');
  const navLive = document.getElementById('navLive');
  const navChat = document.getElementById('navChat');
  const homeSection = document.getElementById('homeSection');
  const liveSection = document.getElementById('liveSection');
  const chatSection = document.getElementById('chatSection');
  
  // Elements for live data
  const tempValue = document.getElementById('tempValue');
  const humValue = document.getElementById('humValue');
  const waterValue = document.getElementById('waterValue');
  const waterRing = document.getElementById('waterRing');

  function setActive(link) {
    document.querySelectorAll('.doy-pill').forEach(el => el.classList.remove('active'));
    link.classList.add('active');
  }

  function showSection(section) {
    [homeSection, liveSection, chatSection].forEach(s => s.style.display = 'none');
    section.style.display = 'block';
  }

  navHome.addEventListener('click', e => {
    e.preventDefault();
    showSection(homeSection);
    setActive(navHome);
  });
  navLive.addEventListener('click', e => {
    e.preventDefault();
    showSection(liveSection);
    setActive(navLive);
  });
  navChat.addEventListener('click', e => {
    e.preventDefault();
    showSection(chatSection);
    setActive(navChat);
  });
  
  // ===== Greeting Popup Functionality =====
  const greetingPopup = document.getElementById('greetingPopup');
  function closeGreeting() {
    greetingPopup.style.display = 'none';
  }

  // ===== BLYNK LIVE DATA FETCH & CHART =====
  const BLYNK_TOKEN = "J8iQWaoA1gz7h9_9_LIfyTYOSM0dZI-Q"; // Replace with your real Blynk API token
  const maxDataPoints = 12; // Show data for the last 60 seconds (5s * 12)
  let chartData = {
    labels: [],
    temperature: [],
    humidity: []
  };

  const ctx = document.getElementById('tempHumChart').getContext('2d');
  const tempHumChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: chartData.labels,
      datasets: [
        {
          label: 'Temperature (°C)',
          data: chartData.temperature,
          borderColor: '#ef4444', /* Red for temperature */
          backgroundColor: 'rgba(239, 68, 68, 0.2)',
          tension: 0.3,
          fill: true
        },
        {
          label: 'Humidity (%)',
          data: chartData.humidity,
          borderColor: '#3b82f6', /* Blue for humidity */
          backgroundColor: 'rgba(59, 130, 246, 0.2)',
          tension: 0.3,
          fill: true
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        y: {
          beginAtZero: false,
          title: {
            display: true,
            text: 'Value'
          }
        },
        x: {
          title: {
            display: true,
            text: 'Time'
          }
        }
      },
    }
  });

  async function updateBlynkData() {
    try {
      const responses = await Promise.all([
        fetch(`https://blynk.cloud/external/api/get?token=${BLYNK_TOKEN}&V0`),
        fetch(`https://blynk.cloud/external/api/get?token=${BLYNK_TOKEN}&V1`),
        fetch(`https://blynk.cloud/external/api/get?token=${BLYNK_TOKEN}&V2`)
      ]);
      const [temp, hum, water] = await Promise.all(responses.map(r => r.text()));

      // Get current values
      const currentTemp = tempValue.textContent;
      const currentHum = humValue.textContent;
      const currentWater = waterValue.textContent;

      // Update Live Data values and add flash effect
      if (currentTemp !== temp + ' °C') {
        tempValue.textContent = temp + ' °C';
        tempValue.classList.add('data-flash');
        setTimeout(() => tempValue.classList.remove('data-flash'), 500);
      }
      if (currentHum !== hum + ' %') {
        humValue.textContent = hum + ' %';
        humValue.classList.add('data-flash');
        setTimeout(() => humValue.classList.remove('data-flash'), 500);
      }
      if (currentWater !== water + ' %') {
        waterValue.textContent = water + ' %';
        waterValue.classList.add('data-flash');
        setTimeout(() => waterValue.classList.remove('data-flash'), 500);
      }

      // Update the progress ring for water level
      const circumference = 2 * Math.PI * 15.9155;
      const progress = (100 - parseFloat(water)) / 100 * circumference;
      waterRing.style.strokeDasharray = `${circumference} ${circumference}`;
      waterRing.style.strokeDashoffset = progress;

      // Remove the "animate-pulse" class once data is loaded
      [tempValue, humValue, waterValue].forEach(el => el.classList.remove('animate-pulse'));
      
      // Update chart data
      const now = new Date();
      const timeLabel = `${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}:${String(now.getSeconds()).padStart(2, '0')}`;
      
      if (chartData.labels.length >= maxDataPoints) {
        chartData.labels.shift();
        chartData.temperature.shift();
        chartData.humidity.shift();
      }
      
      chartData.labels.push(timeLabel);
      chartData.temperature.push(parseFloat(temp));
      chartData.humidity.push(parseFloat(hum));
      
      tempHumChart.update();

    } catch (err) {
      console.error("Blynk fetch error:", err);
      tempValue.textContent = 'Err';
      humValue.textContent = 'Err';
      waterValue.textContent = 'Err';
    }
  }

  // Poll Blynk every 5 seconds
  setInterval(updateBlynkData, 5000);
  updateBlynkData();
</script>
</body>
</html>